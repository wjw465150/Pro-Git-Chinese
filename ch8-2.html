<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Pro Git - Pro Git 8.2 Git ä¸å…¶ä»–ç³»ç»Ÿ è¿ç§»åˆ° Git</title>
    <link rel="stylesheet" href="master.css" tppabs="http://progit.org/stylesheets/master.css" type="text/css" media="screen" charset="utf-8"/>
    <script src="jquery.js" tppabs="http://progit.org/javascripts/jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="jquery.github.js" tppabs="http://progit.org/javascripts/jquery.github.js" type="text/javascript" charset="utf-8"></script>
    <link rel='alternate' type='application/rss+xml' href='http://feeds.feedburner.com/ProGitBook' />
  </head>
  <body>
    <div id='wrapper'>
      <div id='header'>
        <h1>Pro Git</h1>
        <h2>professional version control</h2>
      </div>
      <div id='menu'>
        <ul>
          <li><a href="javascript:if(confirm('http://progit.org/  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/'" tppabs="http://progit.org/">Home</a></li>
          <li><a href="javascript:if(confirm('http://progit.org/book  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book'" tppabs="http://progit.org/book">Book</a></li>
          <li><a href="javascript:if(confirm('http://progit.org/blog.html  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/blog.html'" tppabs="http://progit.org/blog.html">Blog</a></li>
          <li><a href="javascript:if(confirm('http://progit.org/about.html  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/about.html'" tppabs="http://progit.org/about.html">About</a></li>
          <li><a href="javascript:if(confirm('http://progit.org/support.html  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/support.html'" tppabs="http://progit.org/support.html">Support Us</a></li>
          <li><a href="javascript:if(confirm('http://github.com/progit  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://github.com/progit'" tppabs="http://github.com/progit" target='_blank' rel='me'>GitHub</a></li>
          <li><a href="javascript:if(confirm('http://twitter.com/twitter  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://twitter.com/twitter'" tppabs="http://twitter.com/twitter" target='_blank' rel='me'>Twitter</a></li>
        </ul>
      </div>
      <div id="message">
        This is an in-progress translation. <br/>
        To help translate the book, please
        fork the book <a href="javascript:if(confirm('http://github.com/progit/progit  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://github.com/progit/progit'" tppabs="http://github.com/progit/progit">at GitHub</a> and push your contributions.
      </div>
      <div id='content'>
        <h2 id='_git'>è¿ç§»åˆ° Git</h2>

<p>å¦‚æœåœ¨å…¶ä»–ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ä¿å­˜äº†æŸé¡¹ç›®çš„ä»£ç è€Œåå†³å®šè½¬è€Œä½¿ç”¨ Gitï¼Œé‚£ä¹ˆè¯¥é¡¹ç›®å¿…é¡»ç»å†æŸç§å½¢å¼çš„è¿ç§»ã€‚æœ¬èŠ‚å°†ä»‹ç» Git ä¸­åŒ…å«çš„ä¸€äº›é’ˆå¯¹å¸¸è§ç³»ç»Ÿçš„å¯¼å…¥è„šæœ¬ï¼Œå¹¶å°†å±•ç¤ºç¼–å†™è‡ªå®šä¹‰çš„å¯¼å…¥è„šæœ¬çš„æ–¹æ³•ã€‚</p>

<h3 id='id394'>å¯¼å…¥</h3>

<p>ä½ å°†å­¦ä¹ åˆ°å¦‚ä½•ä»ä¸“ä¸šé‡é‡çº§çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­å¯¼å…¥æ•°æ®â€”â€” Subversion å’Œ Perforce â€”â€” å› ä¸ºæ®æˆ‘æ‰€çŸ¥è¿™äºŒè€…çš„ç”¨æˆ·æ˜¯ï¼ˆå‘ Gitï¼‰è½¬æ¢çš„ä¸»è¦ç¾¤ä½“ï¼Œè€Œä¸” Git ä¸ºæ­¤äºŒè€…é™„å¸¦äº†é«˜è´¨é‡çš„è½¬æ¢å·¥å…·ã€‚</p>

<h3 id='subversion'>Subversion</h3>

<p>è¯»è¿‡å‰ä¸€èŠ‚æœ‰å…³ <code>git svn</code> çš„å†…å®¹ä»¥åï¼Œä½ åº”è¯¥èƒ½è½»è€Œæ˜“ä¸¾çš„æ ¹æ®å…¶ä¸­çš„æŒ‡å¯¼æ¥ <code>git svn clone</code> ä¸€ä¸ªä»“åº“äº†ï¼›ç„¶åï¼Œåœæ­¢ Subversion çš„ä½¿ç”¨ï¼Œå‘ä¸€ä¸ªæ–° Git server æ¨é€ï¼Œå¹¶å¼€å§‹ä½¿ç”¨å®ƒã€‚æƒ³ä¿ç•™å†å²è®°å½•ï¼Œæ‰€èŠ±çš„æ—¶é—´åº”è¯¥ä¸è¿‡å°±æ˜¯ä» Subversion æœåŠ¡å™¨æ‹‰å–æ•°æ®çš„æ—¶é—´ï¼ˆå¯èƒ½è¦ç­‰ä¸Šå¥½ä¸€ä¼šå°±æ˜¯äº†ï¼‰ã€‚</p>

<p>ç„¶è€Œï¼Œè¿™æ ·çš„å¯¼å…¥å¹¶ä¸å®Œç¾ï¼›è€Œä¸”è¿˜è¦èŠ±é‚£ä¹ˆå¤šæ—¶é—´ï¼Œä¸å¦‚å¹²è„†ä¸€æ¬¡æŠŠå®ƒåšå¯¹ï¼é¦–å½“å…¶å†²çš„ä»»åŠ¡æ˜¯ä½œè€…ä¿¡æ¯ã€‚åœ¨ Subversionï¼Œæ¯ä¸ªæäº¤è€…åœ¨éƒ½åœ¨ä¸»æœºä¸Šæœ‰ä¸€ä¸ªç”¨æˆ·åï¼Œè®°å½•åœ¨æäº¤ä¿¡æ¯ä¸­ã€‚ä¸ŠèŠ‚ä¾‹å­ä¸­å¤šå¤„æ˜¾ç¤ºäº† <code>schacon</code> ï¼Œæ¯”å¦‚ <code>blame</code> çš„è¾“å‡ºä»¥åŠ <code>git svn log</code>ã€‚å¦‚æœæƒ³è®©è¿™æ¡ä¿¡æ¯æ›´å¥½çš„æ˜ å°„åˆ° Git ä½œè€…æ•°æ®é‡Œï¼Œåˆ™éœ€è¦ ä» Subversion ç”¨æˆ·ååˆ° Git ä½œè€…çš„ä¸€ä¸ªæ˜ å°„å…³ç³»ã€‚å»ºç«‹ä¸€ä¸ªå«åš <code>user.txt</code> çš„æ–‡ä»¶ï¼Œç”¨å¦‚ä¸‹æ ¼å¼è¡¨ç¤ºæ˜ å°„å…³ç³»ï¼š</p>

<pre><code>schacon = Scott Chacon &lt;schacon@geemail.com&gt;
selse = Someo Nelse &lt;selse@geemail.com&gt;</code></pre>

<p>é€šè¿‡è¯¥å‘½ä»¤å¯ä»¥è·å¾— SVN ä½œè€…çš„åˆ—è¡¨ï¼š</p>

<pre><code>$ svn log --xml | grep author | sort -u | perl -pe &#39;s/.&gt;(.?)&lt;./$1 = /&#39;</code></pre>

<p>å®ƒå°†è¾“å‡º XML æ ¼å¼çš„æ—¥å¿—â€”â€”ä½ å¯ä»¥æ‰¾åˆ°ä½œè€…ï¼Œå»ºç«‹ä¸€ä¸ªå•ç‹¬çš„åˆ—è¡¨ï¼Œç„¶åä» XML ä¸­æŠ½å–å‡ºéœ€è¦çš„ä¿¡æ¯ã€‚ï¼ˆæ˜¾è€Œæ˜“è§ï¼Œæœ¬æ–¹æ³•è¦æ±‚ä¸»æœºä¸Šå®‰è£…äº†<code>grep</code>ï¼Œ<code>sort</code> å’Œ <code>perl</code>.ï¼‰ç„¶åæŠŠè¾“å‡ºé‡å®šå‘åˆ° user.txt æ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥åœ¨æ¯ä¸€é¡¹çš„åé¢æ·»åŠ ç›¸åº”çš„ Git ç”¨æˆ·æ•°æ®ã€‚</p>

<p>ä¸º <code>git svn</code> æä¾›è¯¥æ–‡ä»¶å¯ä»¥ç„¶å®ƒæ›´ç²¾ç¡®çš„æ˜ å°„ä½œè€…æ•°æ®ã€‚ä½ è¿˜å¯ä»¥åœ¨ <code>clone</code> æˆ–è€… <code>init</code>åé¢æ·»åŠ  <code>--no-metadata</code> æ¥é˜»æ­¢ <code>git svn</code> åŒ…å«é‚£äº› Subversion çš„é™„åŠ ä¿¡æ¯ã€‚è¿™æ · <code>import</code> å‘½ä»¤å°±å˜æˆäº†ï¼š</p>

<pre><code>$ git-svn clone http://my-project.googlecode.com/svn/ \
      --authors-file=users.txt --no-metadata -s my_project</code></pre>

<p>ç°åœ¨ <code>my_project</code> ç›®å½•ä¸‹å¯¼å…¥çš„ Subversion åº”è¯¥æ¯”åŸæ¥æ•´æ´å¤šäº†ã€‚åŸæ¥çš„ commit çœ‹ä¸Šå»æ˜¯è¿™æ ·ï¼š</p>

<pre><code>commit 37efa680e8473b615de980fa935944215428a35a
Author: schacon &lt;schacon@4c93b258-373f-11de-be05-5f7a86268029&gt;
Date:   Sun May 3 00:12:22 2009 +0000

    fixed install - go to trunk

    git-svn-id: https://my-project.googlecode.com/svn/trunk@94 4c93b258-373f-11de-
    be05-5f7a86268029</code></pre>

<p>ç°åœ¨æ˜¯è¿™æ ·ï¼š</p>

<pre><code>commit 03a8785f44c8ea5cdb0e8834b7c8e6c469be2ff2
Author: Scott Chacon &lt;schacon@geemail.com&gt;
Date:   Sun May 3 00:12:22 2009 +0000

    fixed install - go to trunk</code></pre>

<p>ä¸ä»…ä½œè€…ä¸€é¡¹å¹²å‡€äº†ä¸å°‘ï¼Œ<code>git-svn-id</code> ä¹Ÿå°±æ­¤æ¶ˆå¤±äº†ã€‚</p>

<p>ä½ è¿˜éœ€è¦ä¸€ç‚¹ <code>post-importï¼ˆå¯¼å…¥åï¼‰</code> æ¸…ç†å·¥ä½œã€‚æœ€èµ·ç çš„ï¼Œåº”è¯¥æ¸…ç†ä¸€ä¸‹ <code>git svn</code> åˆ›å»ºçš„é‚£äº›æ€ªå¼‚çš„ç´¢å¼•ç»“æ„ã€‚é¦–å…ˆè¦ç§»åŠ¨æ ‡ç­¾ï¼ŒæŠŠå®ƒä»¬ä»å¥‡æ€ªçš„è¿œç¨‹åˆ†æ”¯å˜æˆå®é™…çš„æ ‡ç­¾ï¼Œç„¶åæŠŠå‰©ä¸‹çš„åˆ†æ”¯ç§»åŠ¨åˆ°æœ¬åœ°ã€‚</p>

<p>è¦æŠŠæ ‡ç­¾å˜æˆåˆé€‚çš„ Git æ ‡ç­¾ï¼Œè¿è¡Œ</p>

<pre><code>$ cp -Rf .git/refs/remotes/tags/* .git/refs/tags/
$ rm -Rf .git/refs/remotes/tags</code></pre>

<p>è¯¥å‘½ä»¤å°†åŸæœ¬ä»¥ <code>tag/</code> å¼€å¤´çš„è¿œç¨‹åˆ†æ”¯çš„ç´¢å¼•å˜æˆçœŸæ­£çš„ï¼ˆè½»å·§çš„ï¼‰æ ‡ç­¾ã€‚</p>

<p>æ¥ä¸‹æ¥ï¼ŒæŠŠ <code>refs/remotes</code> ä¸‹é¢å‰©ä¸‹çš„ç´¢å¼•å˜æˆæœ¬åœ°åˆ†æ”¯ï¼š</p>

<pre><code>$ cp -Rf .git/refs/remotes/* .git/refs/heads/
$ rm -Rf .git/refs/remotes</code></pre>

<p>ç°åœ¨æ‰€æœ‰çš„æ—§åˆ†æ”¯éƒ½å˜æˆçœŸæ­£çš„ Git åˆ†æ”¯ï¼Œæ‰€æœ‰çš„æ—§æ ‡ç­¾ä¹Ÿå˜æˆçœŸæ­£çš„ Git æ ‡ç­¾ã€‚æœ€åä¸€é¡¹å·¥ä½œå°±æ˜¯æŠŠæ–°å»ºçš„ Git æœåŠ¡å™¨æ·»åŠ ä¸ºè¿œç¨‹æœåŠ¡å™¨å¹¶ä¸”å‘å®ƒæ¨é€ã€‚ä¸‹é¢æ˜¯æ–°å¢è¿œç¨‹æœåŠ¡å™¨çš„ä¾‹å­ï¼š</p>

<pre><code>$ git remote add origin git@my-git-server:myrepository.git</code></pre>

<p>ä¸ºäº†è®©æ‰€æœ‰çš„åˆ†æ”¯å’Œæ ‡ç­¾éƒ½å¾—åˆ°ä¸Šä¼ ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™æ¡å‘½ä»¤ï¼š</p>

<pre><code>$ git push origin --all</code></pre>

<p>æ‰€æœ‰çš„åˆ†æ”¯å’Œæ ‡ç­¾ç°åœ¨éƒ½åº”è¯¥æ•´é½å¹²å‡€çš„èººåœ¨æ–°çš„ Git æœåŠ¡å™¨é‡Œäº†ã€‚</p>

<h3 id='perforce'>Perforce</h3>

<p>ä½ å°†äº†è§£åˆ°çš„ä¸‹ä¸€ä¸ªè¢«å¯¼å…¥çš„ç³»ç»Ÿæ˜¯ Perforce. Git å‘è¡Œçš„æ—¶å€™åŒæ—¶ä¹Ÿé™„å¸¦äº†ä¸€ä¸ª Perforce å¯¼å…¥è„šæœ¬ï¼Œä¸è¿‡å®ƒæ˜¯åŒ…å«åœ¨æºç çš„ <code>contrib</code> éƒ¨åˆ†â€”â€”è€Œä¸åƒ <code>git svn</code> é‚£æ ·é»˜è®¤å¯ç”¨ã€‚è¿è¡Œå®ƒä¹‹å‰å¿…é¡»è·å– Git çš„æºç ï¼Œå¯ä»¥åœ¨ git.kernel.org ä¸‹è½½ï¼š</p>

<pre><code>$ git clone git://git.kernel.org/pub/scm/git/git.git
$ cd git/contrib/fast-import</code></pre>

<p>åœ¨è¿™ä¸ª <code>fast-import</code> ç›®å½•ä¸‹ï¼Œåº”è¯¥æœ‰ä¸€ä¸ªå«åš <code>git-p4</code> çš„ Python å¯æ‰§è¡Œè„šæœ¬ã€‚ä¸»æœºä¸Šå¿…é¡»è£…æœ‰ Python å’Œ <code>p4</code> å·¥å…·è¯¥å¯¼å…¥æ‰èƒ½æ­£å¸¸è¿›è¡Œã€‚ä¾‹å¦‚ï¼Œä½ è¦ä» Perforce å…¬å…±ä»£ç ä»“åº“ï¼ˆè¯‘æ³¨ï¼š Perforce Public Depotï¼ŒPerforce å®˜æ–¹æä¾›çš„ä»£ç å¯„å­˜æœåŠ¡ï¼‰å¯¼å…¥ Jam å·¥ç¨‹ã€‚ä¸ºäº†è®¾å®šå®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬è¦æŠŠ P4PORT ç¯å¢ƒå˜é‡ export åˆ° Perforce ä»“åº“ï¼š</p>

<pre><code>$ export P4PORT=public.perforce.com:1666</code></pre>

<p>è¿è¡Œ <code>git-p4 clone</code> å‘½ä»¤å°†ä» Perforce æœåŠ¡å™¨å¯¼å…¥ Jam é¡¹ç›®ï¼Œæˆ‘ä»¬éœ€è¦ç»™å‡ºä»“åº“å’Œé¡¹ç›®çš„è·¯å¾„ä»¥åŠå¯¼å…¥çš„ç›®æ ‡è·¯å¾„ï¼š</p>

<pre><code>$ git-p4 clone //public/jam/src@all /opt/p4import
Importing from //public/jam/src@all into /opt/p4import
Reinitialized existing Git repository in /opt/p4import/.git/
Import destination: refs/remotes/p4/master
Importing revision 4409 (100%)</code></pre>

<p>ç°åœ¨å» <code>/opt/p4import</code> ç›®å½•è¿è¡Œä¸€ä¸‹ <code>git log</code> ï¼Œå°±èƒ½çœ‹åˆ°å¯¼å…¥çš„æˆæœï¼š</p>

<pre><code>$ git log -2
commit 1fd4ec126171790efd2db83548b85b1bbbc07dc2
Author: Perforce staff &lt;support@perforce.com&gt;
Date:   Thu Aug 19 10:18:45 2004 -0800

    Drop &#39;rc3&#39; moniker of jam-2.5.  Folded rc2 and rc3 RELNOTES into
    the main part of the document.  Built new tar/zip balls.

    Only 16 months later.

    [git-p4: depot-paths = &quot;//public/jam/src/&quot;: change = 4409]

commit ca8870db541a23ed867f38847eda65bf4363371d
Author: Richard Geiger &lt;rmg@perforce.com&gt;
Date:   Tue Apr 22 20:51:34 2003 -0800

    Update derived jamgram.c

    [git-p4: depot-paths = &quot;//public/jam/src/&quot;: change = 3108]</code></pre>

<p>æ¯ä¸€ä¸ª commit é‡Œéƒ½æœ‰ä¸€ä¸ª <code>git-p4</code> æ ‡è¯†ç¬¦ã€‚è¿™ä¸ªæ ‡è¯†ç¬¦å¯ä»¥ä¿ç•™ï¼Œä»¥é˜²ä»¥åéœ€è¦å¼•ç”¨ Perforce çš„ä¿®æ”¹ç‰ˆæœ¬å·ã€‚ç„¶è€Œï¼Œå¦‚æœæƒ³åˆ é™¤è¿™äº›æ ‡è¯†ç¬¦ï¼Œç°åœ¨æ­£æ˜¯æ—¶å€™â€”â€”åœ¨å¼€å¯æ–°ä»“åº“ä¹‹å‰ã€‚å¯ä»¥é€šè¿‡ <code>git filter-branch</code> æ¥æ‰¹é‡åˆ é™¤è¿™äº›æ ‡è¯†ç¬¦ï¼š</p>

<pre><code>$ git filter-branch --msg-filter &#39;
        sed -e &quot;/^\[git-p4:/d&quot;
&#39;
Rewrite 1fd4ec126171790efd2db83548b85b1bbbc07dc2 (123/123)
Ref &#39;refs/heads/master&#39; was rewritten</code></pre>

<p>ç°åœ¨è¿è¡Œä¸€ä¸‹ <code>git log</code>ï¼Œä½ ä¼šå‘ç°è¿™äº› commit çš„ SHA-1 æ ¡éªŒå€¼éƒ½å‘ç”Ÿäº†æ”¹å˜ï¼Œè€Œé‚£äº› <code>git-p4</code> å­—ä¸²åˆ™ä»æäº¤ä¿¡æ¯é‡Œæ¶ˆå¤±äº†ï¼š</p>

<pre><code>$ git log -2
commit 10a16d60cffca14d454a15c6164378f4082bc5b0
Author: Perforce staff &lt;support@perforce.com&gt;
Date:   Thu Aug 19 10:18:45 2004 -0800

    Drop &#39;rc3&#39; moniker of jam-2.5.  Folded rc2 and rc3 RELNOTES into
    the main part of the document.  Built new tar/zip balls.

    Only 16 months later.

commit 2b6c6db311dd76c34c66ec1c40a49405e6b527b2
Author: Richard Geiger &lt;rmg@perforce.com&gt;
Date:   Tue Apr 22 20:51:34 2003 -0800

    Update derived jamgram.c</code></pre>

<p>è‡³æ­¤å¯¼å…¥å·²ç»å®Œæˆï¼Œå¯ä»¥å¼€å§‹å‘æ–°çš„ Git æœåŠ¡å™¨æ¨é€äº†ã€‚</p>

<h3 id='id395'>è‡ªå®šå¯¼å…¥è„šæœ¬</h3>

<p>å¦‚æœå…ˆå‰çš„ç³»ç»Ÿä¸æ˜¯ Subversion æˆ– Perforce ä¹‹ä¸€ï¼Œå…ˆä¸Šç½‘æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰ä¸ä¹‹å¯¹åº”çš„å¯¼å…¥è„šæœ¬â€”â€”å¯¼å…¥ CVSï¼ŒClear Caseï¼ŒVisual Source Safeï¼Œç”šè‡³å­˜æ¡£ç›®å½•çš„å¯¼å…¥è„šæœ¬å·²ç»å­˜åœ¨ã€‚å‡å¦‚è¿™äº›å·¥å…·éƒ½ä¸é€‚ç”¨ï¼Œæˆ–è€…ä½¿ç”¨çš„å·¥å…·å¾ˆå°‘è§ï¼ŒæŠ‘æˆ–ä½ éœ€è¦å¯¼å…¥è¿‡ç¨‹å…·æœ‰æ›´å¤šå¯åˆ¶å®šæ€§ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ <code>git fast-import</code>ã€‚è¯¥å‘½ä»¤ä»æ ‡å‡†è¾“å…¥è¯»å–ç®€å•çš„æŒ‡ä»¤æ¥å†™å…¥å…·ä½“çš„ Git æ•°æ®ã€‚è¿™æ ·åˆ›å»º Git å¯¹è±¡æ¯”è¿è¡Œçº¯ Git å‘½ä»¤æˆ–è€…æ‰‹åŠ¨å†™å¯¹è±¡è¦ç®€å•çš„å¤šï¼ˆæ›´å¤šç›¸å…³å†…å®¹è§ç¬¬ä¹ç« ï¼‰ã€‚é€šè¿‡å®ƒï¼Œä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªå¯¼å…¥è„šæœ¬æ¥ä»å¯¼å…¥æºè¯»å–å¿…è¦çš„ä¿¡æ¯ï¼ŒåŒæ—¶åœ¨æ ‡å‡†è¾“å‡ºç›´æ¥è¾“å‡ºç›¸å…³æŒ‡ç¤ºã€‚ä½ å¯ä»¥è¿è¡Œè¯¥è„šæœ¬å¹¶æŠŠå®ƒçš„è¾“å‡ºç®¡é“è¿æ¥åˆ° <code>git fast-import</code>ã€‚</p>

<p>ä¸‹é¢æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•ç¼–å†™ä¸€ä¸ªç®€å•çš„å¯¼å…¥è„šæœ¬ã€‚å‡è®¾ä½ åœ¨è¿›è¡Œä¸€é¡¹å·¥ä½œï¼Œå¹¶ä¸”æŒ‰æ—¶é€šè¿‡æŠŠå·¥ä½œç›®å½•å¤åˆ¶ä¸ºä»¥æ—¶é—´æˆ³ <code>back_YY_MM_DD</code> å‘½åçš„ç›®å½•æ¥è¿›è¡Œå¤‡ä»½ï¼Œç°åœ¨ä½ éœ€è¦æŠŠå®ƒä»¬å¯¼å…¥ Git ã€‚ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>

<pre><code>$ ls /opt/import_from
back_2009_01_02
back_2009_01_04
back_2009_01_14
back_2009_02_03
current</code></pre>

<p>ä¸ºäº†å¯¼å…¥åˆ°ä¸€ä¸ª Git ç›®å½•ï¼Œæˆ‘ä»¬é¦–å…ˆå›é¡¾ä¸€ä¸‹ Git å‚¨å­˜æ•°æ®çš„æ–¹å¼ã€‚ä½ å¯èƒ½è¿˜è®°å¾—ï¼ŒGit æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª commit å¯¹è±¡çš„é“¾è¡¨ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡æŒ‡å‘ä¸€ä¸ªå†…å®¹çš„å¿«ç…§ã€‚è€Œè¿™é‡Œéœ€è¦åšçš„å·¥ä½œå°±æ˜¯å‘Šè¯‰ <code>fast-import</code> å†…å®¹å¿«ç…§çš„ä½ç½®ï¼Œä»€ä¹ˆæ ·çš„ commit æ•°æ®æŒ‡å‘å®ƒä»¬ï¼Œä»¥åŠå®ƒä»¬çš„é¡ºåºã€‚æˆ‘ä»¬é‡‡å–ä¸€æ¬¡å¤„ç†ä¸€ä¸ªå¿«ç…§çš„ç­–ç•¥ï¼Œä¸ºæ¯ä¸€ä¸ªå†…å®¹ç›®å½•å»ºç«‹å¯¹åº”çš„ commit ï¼Œæ¯ä¸€ä¸ª commit ä¸ä¹‹å‰çš„å»ºç«‹é“¾æ¥ã€‚</p>

<p>æ­£å¦‚åœ¨ç¬¬ä¸ƒç«  &#8220;Git æ‰§è¡Œç­–ç•¥ä¸€ä¾‹&#8221; ä¸€èŠ‚ä¸­ä¸€æ ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Ruby æ¥ç¼–å†™è¿™ä¸ªè„šæœ¬ï¼Œå› ä¸ºå®ƒæ˜¯æˆ‘æ—¥å¸¸ä½¿ç”¨çš„è¯­è¨€è€Œä¸”é˜…è¯»èµ·æ¥ç®€å•ä¸€äº›ã€‚ä½ å¯ä»¥ç”¨ä»»ä½•å…¶ä»–ç†Ÿæ‚‰çš„è¯­è¨€æ¥é‡å†™è¿™ä¸ªä¾‹å­â€”â€”å®ƒä»…éœ€è¦æŠŠå¿…è¦çš„ä¿¡æ¯æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè€Œå·²ã€‚åŒæ—¶ï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨ Windowsï¼Œè¿™æ„å‘³ç€ä½ è¦ç‰¹åˆ«ç•™æ„ä¸è¦åœ¨æ¢è¡Œçš„æ—¶å€™å¼•å…¥å›è½¦ç¬¦ï¼ˆè¯‘æ³¨ï¼šcarriage returnsï¼ŒWindows æ¢è¡Œæ—¶åŠ å…¥çš„ç¬¦å·ï¼Œé€šå¸¸è¯´çš„ <code>\r</code> ï¼‰â€”â€” Git çš„ fast-import å¯¹ä»…ä½¿ç”¨æ¢è¡Œç¬¦ï¼ˆLFï¼‰è€Œé Windows çš„å›è½¦ç¬¦ï¼ˆCRLFï¼‰è¦æ±‚éå¸¸ä¸¥æ ¼ã€‚</p>

<p>é¦–å…ˆï¼Œè¿›å…¥ç›®æ ‡ç›®å½•å¹¶ä¸”æ‰¾åˆ°æ‰€æœ‰å­ç›®å½•ï¼Œæ¯ä¸€ä¸ªå­ç›®å½•å°†ä½œä¸ºä¸€ä¸ªå¿«ç…§è¢«å¯¼å…¥ä¸ºä¸€ä¸ª commitã€‚æˆ‘ä»¬å°†ä¾æ¬¡è¿›å…¥æ¯ä¸€ä¸ªå­ç›®å½•å¹¶æ‰“å°æ‰€éœ€çš„å‘½ä»¤æ¥å¯¼å‡ºå®ƒä»¬ã€‚è„šæœ¬çš„ä¸»å¾ªç¯å¤§è‡´æ˜¯è¿™æ ·ï¼š</p>

<pre><code>last_mark = nil

# å¾ªç¯éå†æ‰€æœ‰ç›®å½•
Dir.chdir(ARGV[0]) do
  Dir.glob(&quot;*&quot;).each do |dir|
    next if File.file?(dir)

    # è¿›å…¥ç›®æ ‡ç›®å½•
    Dir.chdir(dir) do 
      last_mark = print_export(dir, last_mark)
    end
  end
end</code></pre>

<p>æˆ‘ä»¬åœ¨æ¯ä¸€ä¸ªç›®å½•é‡Œè¿è¡Œ <code>print_export</code> ï¼Œå®ƒä¼šå–å‡ºä¸Šä¸€ä¸ªå¿«ç…§çš„ç´¢å¼•å’Œæ ‡è®°å¹¶è¿”å›æœ¬æ¬¡å¿«ç…§çš„ç´¢å¼•å’Œæ ‡è®°ï¼›ç”±æ­¤æˆ‘ä»¬å°±å¯ä»¥æ­£ç¡®çš„æŠŠäºŒè€…è¿æ¥èµ·æ¥ã€‚&#8221;æ ‡è®°ï¼ˆmarkï¼‰&#8221; æ˜¯ <code>fast-import</code> ä¸­å¯¹ commit æ ‡è¯†ç¬¦çš„å«æ³•ï¼›åœ¨åˆ›å»º commit çš„åŒæ—¶ï¼Œæˆ‘ä»¬é€ä¸€èµ‹äºˆä¸€ä¸ªæ ‡è®°ä»¥ä¾¿ä»¥ååœ¨æŠŠå®ƒè¿æ¥åˆ°å…¶ä»– commit æ—¶ä½¿ç”¨ã€‚å› æ­¤ï¼Œåœ¨ <code>print_export</code> æ–¹æ³•ä¸­è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ ¹æ®ç›®å½•åç”Ÿæˆä¸€ä¸ªæ ‡è®°ï¼š</p>

<pre><code>mark = convert_dir_to_mark(dir)</code></pre>

<p>å®ç°è¯¥å‡½æ•°çš„æ–¹æ³•æ˜¯å»ºç«‹ä¸€ä¸ªç›®å½•çš„æ•°ç»„åºåˆ—å¹¶ä½¿ç”¨æ•°ç»„çš„ç´¢å¼•å€¼ä½œä¸ºæ ‡è®°ï¼Œå› ä¸ºæ ‡è®°å¿…é¡»æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚è¿™ä¸ªæ–¹æ³•å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š</p>

<pre><code>$marks = []
def convert_dir_to_mark(dir)
  if !$marks.include?(dir)
    $marks &lt;&lt; dir
  end
  ($marks.index(dir) + 1).to_s
end</code></pre>

<p>æœ‰äº†æ•´æ•°æ¥ä»£è¡¨æ¯ä¸ª commitï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦æäº¤é™„åŠ ä¿¡æ¯ä¸­çš„æ—¥æœŸã€‚ç”±äºæ—¥æœŸæ˜¯ç”¨ç›®å½•åè¡¨ç¤ºçš„ï¼Œæˆ‘ä»¬å°±ä»ä¸­è§£æå‡ºæ¥ã€‚<code>print_export</code> æ–‡ä»¶çš„ä¸‹ä¸€è¡Œå°†æ˜¯ï¼š</p>

<pre><code>date = convert_dir_to_date(dir)</code></pre>

<p>è€Œ <code>convert_dir_to_date</code> åˆ™å®šä¹‰ä¸º</p>

<pre><code>def convert_dir_to_date(dir)
  if dir == &#39;current&#39;
    return Time.now().to_i
  else
    dir = dir.gsub(&#39;back_&#39;, &#39;&#39;)
    (year, month, day) = dir.split(&#39;_&#39;)
    return Time.local(year, month, day).to_i
  end
end</code></pre>

<p>å®ƒä¸ºæ¯ä¸ªç›®å½•è¿”å›ä¸€ä¸ªæ•´å‹å€¼ã€‚æäº¤é™„åŠ ä¿¡æ¯é‡Œæœ€åä¸€é¡¹æ‰€éœ€çš„æ˜¯æäº¤è€…æ•°æ®ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ç›´æ¥å®šä¹‰ä¹‹ï¼š</p>

<pre><code>$author = &#39;Scott Chacon &lt;schacon@example.com&gt;&#39;</code></pre>

<p>æˆ‘ä»¬å·®ä¸å¤šå¯ä»¥å¼€å§‹ä¸ºå¯¼å…¥è„šæœ¬è¾“å‡ºæäº¤æ•°æ®äº†ã€‚ç¬¬ä¸€é¡¹ä¿¡æ¯æŒ‡æ˜æˆ‘ä»¬å®šä¹‰çš„æ˜¯ä¸€ä¸ª commit å¯¹è±¡ä»¥åŠå®ƒæ‰€åœ¨çš„åˆ†æ”¯ï¼Œéšåæ˜¯æˆ‘ä»¬ç”Ÿæˆçš„æ ‡è®°ï¼Œæäº¤è€…ä¿¡æ¯ä»¥åŠæäº¤å¤‡æ³¨ï¼Œç„¶åæ˜¯å‰ä¸€ä¸ª commit çš„ç´¢å¼•ï¼Œå¦‚æœæœ‰çš„è¯ã€‚ä»£ç å¤§è‡´è¿™æ ·ï¼š</p>

<pre><code># æ‰“å°å¯¼å…¥æ‰€éœ€çš„ä¿¡æ¯
puts &#39;commit refs/heads/master&#39;
puts &#39;mark :&#39; + mark
puts &quot;committer #{$author} #{date} -0700&quot;
export_data(&#39;imported from &#39; + dir)
puts &#39;from :&#39; + last_mark if last_mark</code></pre>

<p>æ—¶åŒºï¼ˆ-0700ï¼‰å¤„äºç®€åŒ–ç›®çš„ä½¿ç”¨ç¡¬ç¼–ç ã€‚å¦‚æœæ˜¯ä»å…¶ä»–ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå¯¼å…¥ï¼Œåˆ™å¿…é¡»ä»¥å˜é‡çš„å½¢å¼æŒ‡æ˜æ—¶åŒºã€‚ æäº¤å¤‡æ³¨å¿…é¡»ä»¥ç‰¹å®šæ ¼å¼ç»™å‡ºï¼š</p>

<pre><code>data (size)\n(contents)</code></pre>

<p>è¯¥æ ¼å¼åŒ…å«äº†å•è¯ dataï¼Œæ‰€è¯»å–æ•°æ®çš„å¤§å°ï¼Œä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œæœ€åæ˜¯æ•°æ®æœ¬èº«ã€‚ç”±äºéšåæŒ‡æ˜æ–‡ä»¶å†…å®¹çš„æ—¶å€™è¦ç”¨åˆ°ç›¸åŒçš„æ ¼å¼ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼Œ<code>export_data</code>ï¼š</p>

<pre><code>def export_data(string)
  print &quot;data #{string.size}\n#{string}&quot;
end</code></pre>

<p>å”¯ä¸€å‰©ä¸‹çš„å°±æ˜¯æ¯ä¸€ä¸ªå¿«ç…§çš„å†…å®¹äº†ã€‚è¿™ç®€å•çš„å¾ˆï¼Œå› ä¸ºå®ƒä»¬åˆ†åˆ«å¤„äºä¸€ä¸ªç›®å½•â€”â€”ä½ å¯ä»¥è¾“å‡º <code>deleeall</code> å‘½ä»¤ï¼Œéšåæ˜¯ç›®å½•ä¸­æ¯ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚Git ä¼šæ­£ç¡®çš„è®°å½•æ¯ä¸€ä¸ªå¿«ç…§ï¼š</p>

<pre><code>puts &#39;deleteall&#39;
Dir.glob(&quot;**/*&quot;).each do |file| next if !File.file?(file)
  inline_data(file)
end</code></pre>

<p>æ³¨æ„ï¼šç”±äºå¾ˆå¤šç³»ç»ŸæŠŠæ¯æ¬¡ä¿®è®¢çœ‹ä½œä¸€ä¸ª commit åˆ°å¦ä¸€ä¸ª commit çš„å˜åŒ–é‡ï¼Œfast-import ä¹Ÿå¯ä»¥ä¾æ®æ¯æ¬¡æäº¤è·å–ä¸€ä¸ªå‘½ä»¤æ¥æŒ‡å‡ºå“ªäº›æ–‡ä»¶è¢«æ·»åŠ ï¼Œåˆ é™¤æˆ–è€…ä¿®æ”¹è¿‡ï¼Œä»¥åŠä¿®æ”¹çš„å†…å®¹ã€‚æˆ‘ä»¬å°†éœ€è¦è®¡ç®—å¿«ç…§ä¹‹é—´çš„å·®åˆ«å¹¶ä¸”ä»…ä»…ç»™å‡ºè¿™é¡¹æ•°æ®ï¼Œä¸è¿‡è¯¥åšæ³•è¦å¤æ‚å¾ˆå¤šâ€”â€”è¿˜å¦‚ä¸ç›´æ¥æŠŠæ‰€æœ‰æ•°æ®ä¸¢ç»™ Git ç„¶å®ƒè‡ªå·±ææ¸…æ¥šã€‚å‡å¦‚å‰é¢è¿™ä¸ªæ–¹æ³•æ›´é€‚ç”¨äºä½ çš„æ•°æ®ï¼Œå‚è€ƒ <code>fast-import</code> çš„ man å¸®åŠ©é¡µé¢æ¥äº†è§£å¦‚ä½•ä»¥è¿™ç§æ–¹å¼æä¾›æ•°æ®ã€‚</p>

<p>åˆ—ä¸¾æ–°æ–‡ä»¶å†…å®¹æˆ–è€…æŒ‡æ˜å¸¦æœ‰æ–°å†…å®¹çš„å·²ä¿®æ”¹æ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>

<pre><code>M 644 inline path/to/file
data (size)
(file contents)</code></pre>

<p>è¿™é‡Œï¼Œ644 æ˜¯æƒé™æ¨¡å¼ï¼ˆåŠ å…¥æœ‰å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåˆ™éœ€è¦æ¢æµ‹ä¹‹å¹¶è®¾å®šä¸º 755ï¼‰ï¼Œè€Œ inline è¯´æ˜æˆ‘ä»¬åœ¨æœ¬è¡Œç»“æŸä¹‹åç«‹å³åˆ—å‡ºæ–‡ä»¶çš„å†…å®¹ã€‚æˆ‘ä»¬çš„ <code>inline_data</code> æ–¹æ³•å¤§è‡´æ˜¯ï¼š</p>

<pre><code>def inline_data(file, code = &#39;M&#39;, mode = &#39;644&#39;)
  content = File.read(file)
  puts &quot;#{code} #{mode} inline #{file}&quot;
  export_data(content)
end</code></pre>

<p>æˆ‘ä»¬é‡ç”¨äº†å‰é¢å®šä¹‰è¿‡çš„ <code>export_data</code>ï¼Œå› ä¸ºè¿™é‡Œå’ŒæŒ‡æ˜æäº¤æ³¨é‡Šçš„æ ¼å¼å¦‚å‡ºä¸€è¾™ã€‚</p>

<p>æœ€åä¸€é¡¹å·¥ä½œæ˜¯è¿”å›å½“å‰çš„æ ‡è®°ä»¥ä¾¿ä¸‹æ¬¡å¾ªç¯çš„ä½¿ç”¨ã€‚</p>

<pre><code>return mark</code></pre>

<p>æ³¨æ„ï¼šå¦‚æœä½ åœ¨ç”¨ Windowsï¼Œä¸€å®šè®°å¾—æ·»åŠ ä¸€é¡¹é¢å¤–çš„æ­¥éª¤ã€‚å‰é¢æè¿‡ï¼ŒWindows ä½¿ç”¨ CRLF ä½œä¸ºæ¢è¡Œå­—ç¬¦è€Œ Git fast-import åªæ¥å— LFã€‚ä¸ºäº†ç»•å¼€è¿™ä¸ªé—®é¢˜æ¥æ»¡è¶³ git fast-importï¼Œä½ éœ€è¦è®© ruby ç”¨ LF å–ä»£ CRLFï¼š</p>

<pre><code>$stdout.binmode</code></pre>

<p>æå®šäº†ã€‚ç°åœ¨è¿è¡Œè¯¥è„šæœ¬ï¼Œä½ å°†å¾—åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p>

<pre><code>$ ruby import.rb /opt/import_from 
commit refs/heads/master
mark :1
committer Scott Chacon &lt;schacon@geemail.com&gt; 1230883200 -0700
data 29
imported from back_2009_01_02deleteall
M 644 inline file.rb
data 12
version two
commit refs/heads/master
mark :2
committer Scott Chacon &lt;schacon@geemail.com&gt; 1231056000 -0700
data 29
imported from back_2009_01_04from :1
deleteall
M 644 inline file.rb
data 14
version three
M 644 inline new.rb
data 16
new version one
(...)</code></pre>

<p>è¦è¿è¡Œå¯¼å…¥è„šæœ¬ï¼Œåœ¨éœ€è¦å¯¼å…¥çš„ç›®å½•æŠŠè¯¥å†…å®¹ç”¨ç®¡é“å®šå‘åˆ° <code>git fast-import</code>ã€‚ä½ å¯ä»¥å»ºç«‹ä¸€ä¸ªç©ºç›®å½•ç„¶åè¿è¡Œ <code>git init</code> ä½œä¸ºå¼€å¤´ï¼Œç„¶åè¿è¡Œè¯¥è„šæœ¬ï¼š</p>

<pre><code>$ git init
Initialized empty Git repository in /opt/import_to/.git/
$ ruby import.rb /opt/import_from | git fast-import
git-fast-import statistics:
---------------------------------------------------------------------
Alloc&#39;d objects:       5000
Total objects:           18 (         1 duplicates                  )
      blobs  :            7 (         1 duplicates          0 deltas)
      trees  :            6 (         0 duplicates          1 deltas)
      commits:            5 (         0 duplicates          0 deltas)
      tags   :            0 (         0 duplicates          0 deltas)
Total branches:           1 (         1 loads     )
      marks:           1024 (         5 unique    )
      atoms:              3
Memory total:          2255 KiB
       pools:          2098 KiB
     objects:           156 KiB
---------------------------------------------------------------------
pack_report: getpagesize()            =       4096
pack_report: core.packedGitWindowSize =   33554432
pack_report: core.packedGitLimit      =  268435456
pack_report: pack_used_ctr            =          9
pack_report: pack_mmap_calls          =          5
pack_report: pack_open_windows        =          1 /          1
pack_report: pack_mapped              =       1356 /       1356
---------------------------------------------------------------------</code></pre>

<p>ä½ ä¼šå‘ç°ï¼Œåœ¨å®ƒæˆåŠŸæ‰§è¡Œå®Œæ¯•ä»¥åï¼Œä¼šç»™å‡ºä¸€å †æœ‰å…³å·²å®Œæˆå·¥ä½œçš„æ•°æ®ã€‚ä¸Šä¾‹åœ¨ä¸€ä¸ªåˆ†æ”¯å¯¼å…¥äº†5æ¬¡æäº¤æ•°æ®ï¼ŒåŒ…å«äº†18ä¸ªå¯¹è±¡ã€‚ç°åœ¨å¯ä»¥è¿è¡Œ <code>git log</code> æ¥æ£€è§†æ–°çš„å†å²ï¼š</p>

<pre><code>$ git log -2
commit 10bfe7d22ce15ee25b60a824c8982157ca593d41
Author: Scott Chacon &lt;schacon@example.com&gt;
Date:   Sun May 3 12:57:39 2009 -0700

    imported from current

commit 7e519590de754d079dd73b44d695a42c9d2df452
Author: Scott Chacon &lt;schacon@example.com&gt;
Date:   Tue Feb 3 01:00:00 2009 -0700

    imported from back_2009_02_03</code></pre>

<p>å°±å®ƒäº†â€”â€”ä¸€ä¸ªå¹²å‡€æ•´æ´çš„ Git ä»“åº“ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ—¶æ²¡æœ‰ä»»ä½•å†…å®¹è¢«æ£€å‡ºâ€”â€”åˆšå¼€å§‹å½“å‰ç›®å½•é‡Œæ²¡æœ‰ä»»ä½•æ–‡ä»¶ã€‚è¦è·å–å®ƒä»¬ï¼Œä½ å¾—è½¬åˆ° <code>master</code> åˆ†æ”¯çš„æ‰€åœ¨ï¼š</p>

<pre><code>$ ls
$ git reset --hard master
HEAD is now at 10bfe7d imported from current
$ ls
file.rb  lib</code></pre>

<p><code>fast-import</code> è¿˜å¯ä»¥åšæ›´å¤šâ€”â€”å¤„ç†ä¸åŒçš„æ–‡ä»¶æ¨¡å¼ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¤šé‡åˆ†æ”¯ä¸åˆå¹¶ï¼Œæ ‡ç­¾ï¼Œè¿›å±•æ ‡è¯†ç­‰ç­‰ã€‚ä¸€äº›æ›´åŠ å¤æ‚çš„å®ä¾‹å¯ä»¥åœ¨ Git æºç çš„ <code>contib/fast-import</code> ç›®å½•é‡Œæ‰¾åˆ°ï¼›å…¶ä¸­è¾ƒä¸ºå‡ºä¼—çš„æ˜¯å‰é¢æè¿‡çš„ <code>git-p4</code> è„šæœ¬ã€‚</p>

<div id='nav'>
<a href="ch8-1.html" tppabs="http://progit.org/book/zh/ch8-1.html">prev</a> | <a href="ch8-3.html" tppabs="http://progit.org/book/zh/ch8-3.html">next</a>
</div>
        <div class='clearfix'></div>
      </div>
    </div>
    <div id='footer'>
      Book translated into 
        <a href="javascript:if(confirm('http://progit.org/book/de  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/de'" tppabs="http://progit.org/book/de">German</a>, 
        <a href="javascript:if(confirm('http://progit.org/book/zh  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/zh'" tppabs="http://progit.org/book/zh">Chinese</a>, 
        <a href="javascript:if(confirm('http://progit.org/book/ja  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/ja'" tppabs="http://progit.org/book/ja">Japanese</a> and 
        <a href="javascript:if(confirm('http://progit.org/book/nl  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/nl'" tppabs="http://progit.org/book/nl">Dutch</a>.<br/>
      Partial translations available in 
        <a href="javascript:if(confirm('http://progit.org/book/ar  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/ar'" tppabs="http://progit.org/book/ar">Arabic</a>,
        <a href="javascript:if(confirm('http://progit.org/book/cs  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/cs'" tppabs="http://progit.org/book/cs">Czech</a>,
        <a href="javascript:if(confirm('http://progit.org/book/es  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/es'" tppabs="http://progit.org/book/es">Spanish</a>,
        <a href="javascript:if(confirm('http://progit.org/book/fr  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/fr'" tppabs="http://progit.org/book/fr">French</a>,
        <a href="javascript:if(confirm('http://progit.org/book/id  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/id'" tppabs="http://progit.org/book/id">Indonesian</a>,
        <a href="javascript:if(confirm('http://progit.org/book/it  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/it'" tppabs="http://progit.org/book/it">Italian</a>,
        <a href="javascript:if(confirm('http://progit.org/book/mk  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/mk'" tppabs="http://progit.org/book/mk">Macedonian</a>,
        <a href="javascript:if(confirm('http://progit.org/book/pl  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/pl'" tppabs="http://progit.org/book/pl">Polish</a>,
        <a href="javascript:if(confirm('http://progit.org/book/th  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/th'" tppabs="http://progit.org/book/th">Thai</a> and
        <a href="javascript:if(confirm('http://progit.org/book/ru  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://progit.org/book/ru'" tppabs="http://progit.org/book/ru">Russian</a>
        .<br/>
      All content under <a href="javascript:if(confirm('http://creativecommons.org/licenses/by-nc-sa/3.0/us/  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://creativecommons.org/licenses/by-nc-sa/3.0/us/'" tppabs="http://creativecommons.org/licenses/by-nc-sa/3.0/us/">Creative Commons Attribution-Non Commercial-Share Alike 3.0 license</a>.
      <br/>Theme and code by <a href="javascript:if(confirm('http://github.com/mbleigh  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://github.com/mbleigh'" tppabs="http://github.com/mbleigh">Michael Bleigh</a>. Hosted by <a href="javascript:if(confirm('http://github.com/progit/progit.github.com/  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://github.com/progit/progit.github.com/'" tppabs="http://github.com/progit/progit.github.com/" target='_blank'>GitHub</a> and powered by <a href="javascript:if(confirm('http://github.com/mojombo/jekyll  \n\n¸ÃÎÄ¼şÎ´±» Teleport Pro ÏÂÔØ£¬ÒòÎª ËüÎ»ÓÚÆğÊ¼µØÖ·ÒÔÉèÖÃµÄ±ß½çÒÔÍâµÄÓò»òÂ·¾¶ÖĞ¡£  \n\nÄãÏëÒª´Ó·şÎñÆ÷´ò¿ªËüÂğ?'))window.location='http://github.com/mojombo/jekyll'" tppabs="http://github.com/mojombo/jekyll">Jekyll</a>.
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www./");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-82337-15");
    pageTracker._trackPageview();
    } catch(err) {}</script>
  </body>
</html>
